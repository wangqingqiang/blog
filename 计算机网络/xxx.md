
## TTL
time to live，指ip4包在被路由器丢弃前允许通过的最大网段数量，最大255，推荐64，每过一个路由器-1  
## 交换机
没有交换机的时候需要数据包向所有端口进行广播，造成冲突概率增大，同时资源浪费。  
交换机一开始也不知道哪个口对应哪个MAC地址，当一个MAC1电脑向交换机发送数据，交换机会向其他所有口发送广播，同时记住MAC1地址来自哪个口，当之后有端口给MAC1发送数据时就不会广播了，而是直接给这个口发数据，时间久了交换机就记住了所有口对应的MAC地址。

## 出网关
### 局域网内
1. 发送端发现不在同一个网段，需要先发送给网关：通过ARP协议找到网关Mac地址，然后发送数据包，格式：
   - 网关的Mac地址
   - 源Mac地址
   - 源IP地址
   - 目的IP地址（真实的目的，不是网关）

2. 网关根据路由表发给下一个网关（最终会是目的地址的网关）
   - 下一跳网关Mac地址
   - 当前网关Mac地址
   - 源IP地址
   - 目的IP地址（真实目的端）

3. 最终的网关发送ARP协议找到目的端Mac地址，发送数据包
   - 目的Mac地址
   - 本网关Mac地址
   - 源IP地址
   - 目的IP地址

**局域网内出网关不会改变源IP和目的IP地址**

### 公网出网关
IP地址会改变，需要用自己的公网IP
